<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="How to find performance bottlenecks in python web applications built with flask, django, asgi.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Find Performance Issues In Web Apps with Sentry | Avil Page</title>
<link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://avilpage.com/2020/11/python-web-applications-performance-sentry.html">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Chillar Anand">
<link rel="prev" href="../10/python-docker-build-slim-fast.html" title="Make Python Docker Builds Slim &amp; Fast" type="text/html">
<link rel="next" href="../12/minimum-viable-testing-risk-based.html" title="Minimum Viable Testing - Get Maximum Stability With Minimum Effort" type="text/html">
<meta property="og:site_name" content="Avil Page">
<meta property="og:title" content="Find Performance Issues In Web Apps with Sentry">
<meta property="og:url" content="https://avilpage.com/2020/11/python-web-applications-performance-sentry.html">
<meta property="og:description" content="How to find performance bottlenecks in python web applications built with flask, django, asgi.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-11-30T23:59:54+05:30">
<meta property="article:tag" content="profiling">
<meta property="article:tag" content="python">
<meta property="article:tag" content="sentry">
<style>
    .full-article-footer {
    border-top: 1px solid #E0DFDB;
}


.article-footer {
    padding: 20px 10px 10px 10px;
    min-height: 115px;
    display:table;
}


.avatar-module {
    display: table-cell;
    vertical-align: middle;
}


.avatar-module img {
    border-radius: 50%!important;
    height: 120px;
    width: 120px;
    float: left;
    margin:0px 20px 0px 20px;
}


.article-footer p {
    line-height:1.5em;
    padding-left:15px;
}


@media (max-width:750px) {
    .article-footer {
        display:inherit;
        margin:0px;
    }

    .avatar-module {
        display:inherit;
        vertical-align: none;
    }

    .avatar-module img {
        margin-left: auto;
        margin-right: auto;
        display: block;
        float:none;
        margin-top:0px;
    }

    .article-footer p {
        text-align:center;
        padding-left:0px;
    }
}

    </style>
<style>

 h1 {
     font-weight: bold;
     font-size: 25px;
 }

</style>
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

    <!-- Menubar -->
    <nav class="navbar navbar-expand-md static-top mb-4
                navbar-dark
                bg-dark
                "><div class="container">
<!-- This keeps the margins nice -->
            <a class="navbar-brand" href="../../">

                    <span id="blog-title">Avil Page</span>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="bs-navbar">
                <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../top-10.html" class="nav-link">Top 10</a>
                </li>
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Articles</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS</a>

                    
                </li>
</ul>
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
        </div>
<!-- /.container -->
    </nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="row justify-content-md-center">
        <div class="body-content col col-lg-6">
            <!--Body content-->
            
    <article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Find Performance Issues In Web Apps with Sentry</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Chillar Anand
            </span></p>

            <p class="dateline">


                    4 min read

            </p>

            <p class="dateline">
                <a href="#" rel="bookmark">
                    <time class="published dt-published" datetime="2020-11-30T23:59:54+05:30" itemprop="datePublished" title="2020-11-30">2020-11-30</time></a>
            </p>
            

        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
            <h4>Introduction</h4>
<p>Earlier, we have seen couple of articles here on finding performance issues<sup id="fnref:perf1"><a class="footnote-ref" href="python-web-applications-performance-sentry.html#fn:perf1">1</a></sup> and how to go about optimizing them<sup id="fnref:perf2"><a class="footnote-ref" href="python-web-applications-performance-sentry.html#fn:perf2">2</a></sup>. In this article, lets see how to use Sentry Performance to find bottlenecks in Python web applications.</p>
<h4>The Pitfalls</h4>
<p>A common pitfall while identifying performance issues is to do profiling in development environment. Performance in development environment will be quite different from production environment due to difference in system requirements, database size, network latency etc.</p>
<p>In some cases, performance issues could be happening only for certain users and in specific scenarios.</p>
<p>Replicating production performance on development machine will be costly. To avoid these, we can use APM tool to monitor performance in production.</p>
<h4>Sentry Performance</h4>
<p>Sentry is widely used Open source error tracking tool. Recently, it has introduced Performance to track performance also. Sentry doesn't need any agent running on the host machine to track performance. Enabling performance monitoring is just a single line change in Sentry<sup id="fnref:sentry"><a class="footnote-ref" href="python-web-applications-performance-sentry.html#fn:sentry">3</a></sup> setup.</p>
<pre class="code literal-block"><span class="kn">import</span> <span class="nn">sentry_sdk</span>


<span class="n">sentry_sdk</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
    <span class="n">dsn</span><span class="o">=</span><span class="s2">"dummy_dsn"</span><span class="p">,</span>
    <span class="c1"># Trace half the requests</span>
    <span class="n">traces_sample_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span>
</pre>
<p>Tracing performance will have additional overhead<sup id="fnref:oh"><a class="footnote-ref" href="python-web-applications-performance-sentry.html#fn:oh">4</a></sup> on the web application response time. Depending on the traffic, server capacity, acceptable overhead, we can decide what percentage of the requests we need to trace.</p>
<p>Once performance is enabled, we can head over to Sentry web application and see traces for the transactions along with operation breakdown as shown below.</p>
<p><img src="../../images/sentry0.png" style="vertical-align:middle"></p>
<p>At a glance, we can see percentage of time spent across each component which will pinpoint where the performance problem lies.</p>
<p>If the app server is taking most of the time, we can explore the spans in detail to pinpoint the exact line where it is taking most time. If database is taking most of the time, we can look out for the number of queries it is running and slowest queries to pinpoint the problem.</p>
<p>Sentry also provides option to set alerts when there are performance. For example, when the response time for a duration are less than a limit for a specified duration, Sentry can alert developers via email, slack or any other integration channels.</p>
<h4>Conclusion</h4>
<p>There are paid APM tools like New Relic, AppDynamics which requires an agent to be installed on the server. As mentioned in earlier articles, there are open source packages like django-silk to monitor performance. It will take time to set up these tools and pinpoint the issue.</p>
<p>Sentry is the only agentless APM tool<sup id="fnref:note"><a class="footnote-ref" href="python-web-applications-performance-sentry.html#fn:note">5</a></sup> available for Python applications. Setting up Sentry performance is quite easy and performance issues can be pinpointed without much hassle.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:perf1">
<p><a href="../../2018/12/django-bottleneck-performance-scaling.html">Finding High-impact Performance Bottlenecks</a> <a class="footnote-backref" href="python-web-applications-performance-sentry.html#fnref:perf1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:perf2">
<p><a href="../../2019/08/django-profile-optimize-views.html">Optimizing Bottlenecks In Django</a> <a class="footnote-backref" href="python-web-applications-performance-sentry.html#fnref:perf2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn:sentry">
<p><a href="https://docs.sentry.io/platforms/python/performance/">Sentry - Performance Monitoring</a> <a class="footnote-backref" href="python-web-applications-performance-sentry.html#fnref:sentry" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
<li id="fn:oh">
<p><a href="https://github.com/getsentry/sentry-python/issues/668#issuecomment-707768485">Sentry has 8% overhead in Django test suite</a> <a class="footnote-backref" href="python-web-applications-performance-sentry.html#fnref:oh" title="Jump back to footnote 4 in the text">↩</a></p>
</li>
<li id="fn:note">
<p>Earlier there was Opbeat APM which is now shutdown due to acquistion by Elastic. <a class="footnote-backref" href="python-web-applications-performance-sentry.html#fnref:note" title="Jump back to footnote 5 in the text">↩</a></p>
</li>
</ol>
</div>
        </div>
        <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../tags/profiling.html" rel="tag">profiling</a></li>
            <li><a class="tag p-category" href="../../tags/python.html" rel="tag">python</a></li>
            <li><a class="tag p-category" href="../../tags/sentry.html" rel="tag">sentry</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../10/python-docker-build-slim-fast.html" rel="prev" title="Make Python Docker Builds Slim &amp; Fast">Previous post</a>
            </li>
            <li class="next">
                <a href="../12/minimum-viable-testing-risk-based.html" rel="next" title="Minimum Viable Testing - Get Maximum Stability With Minimum Effort">Next post</a>
            </li>
        </ul></nav></aside><div class="full-article-footer">
            <div class="article-footer">

                <div class="avatar-module">
                    <img class="avatar" height="100px" src="../../images/chillaranand.jpg">
</div>

                <p class="avatar-module">
                    Written by
                    <br><b>Chillar Anand</b>
                    <br>
                    Musings about programming, careers &amp; life.
                </p>

            </div>
        </div>

        
    </article><!--End of body content--><footer id="footer"><div class="container align-items-center justify-content-center d-flex">

<footer class="footer"><a href="https://github.com/ChillarAnand">
<img src="../../images/icons8-github.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://stackoverflow.com/users/2698552/chillar-anand">
<img src="../../images/icons8-so.svg" alt="github-chillar-anand" height="30"></a>

  

<a href="https://youtube.com/@avilpage">
<img src="../../images/icons8-youtube.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://linkedin.com/in/chillaranand">
<img src="../../images/icons8-linkedin.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://twitter.com/chillaranand">
<img src="../../images/icons8-twitter.svg" alt="github-chillar-anand" height="34"></a>

</footer>
</div>

<br><br></footer>
</div>
    </div>
    </div>

                <script src="../../assets/js/jquery.min.js"></script><script src="../../assets/js/popper.min.js"></script><script src="../../assets/js/bootstrap.min.js"></script><script src="../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
