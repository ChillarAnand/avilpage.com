<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="How to Deploy NextGen Connect (aka Mirth Connect) to a Kubernetes cluster.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How To Deploy Mirth Connect To Kubernetes | Avil Page</title>
<link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://avilpage.com/2020/07/deploy-mirth-to-kubernetes.html">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Chillar Anand">
<link rel="prev" href="../08/bluetooth-terminal-python-asyncio.html" title="Serial Bluetooth Terminal With Python Asyncio" type="text/html">
<link rel="next" href="../10/python-docker-build-slim-fast.html" title="Make Python Docker Builds Slim &amp; Fast" type="text/html">
<meta property="og:site_name" content="Avil Page">
<meta property="og:title" content="How To Deploy Mirth Connect To Kubernetes">
<meta property="og:url" content="https://avilpage.com/2020/07/deploy-mirth-to-kubernetes.html">
<meta property="og:description" content="How to Deploy NextGen Connect (aka Mirth Connect) to a Kubernetes cluster.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-09-30T23:25:46+05:30">
<meta property="article:tag" content="aws">
<meta property="article:tag" content="devops">
<meta property="article:tag" content="HealthIT">
<meta property="article:tag" content="kubernetes">
<style>
    .full-article-footer {
    border-top: 1px solid #E0DFDB;
}


.article-footer {
    padding: 20px 10px 10px 10px;
    min-height: 115px;
    display:table;
}


.avatar-module {
    display: table-cell;
    vertical-align: middle;
}


.avatar-module img {
    border-radius: 50%!important;
    height: 120px;
    width: 120px;
    float: left;
    margin:0px 20px 0px 20px;
}


.article-footer p {
    line-height:1.5em;
    padding-left:15px;
}


@media (max-width:750px) {
    .article-footer {
        display:inherit;
        margin:0px;
    }

    .avatar-module {
        display:inherit;
        vertical-align: none;
    }

    .avatar-module img {
        margin-left: auto;
        margin-right: auto;
        display: block;
        float:none;
        margin-top:0px;
    }

    .article-footer p {
        text-align:center;
        padding-left:0px;
    }
}

    </style>
<style>

 h1 {
     font-weight: bold;
     font-size: 25px;
 }

</style>
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

    <!-- Menubar -->
    <nav class="navbar navbar-expand-md static-top mb-4
                navbar-dark
                bg-dark
                "><div class="container">
<!-- This keeps the margins nice -->
            <a class="navbar-brand" href="../../">

                    <span id="blog-title">Avil Page</span>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="bs-navbar">
                <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../top-10.html" class="nav-link">Top 10</a>
                </li>
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Tech</a>
                </li>
<li class="nav-item">
<a href="../../non-tech.html" class="nav-link">Non-tech</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS</a>

                    
                </li>
</ul>
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
        </div>
<!-- /.container -->
    </nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="row justify-content-md-center">
        <div class="body-content col col-lg-6">
            <!--Body content-->
            
    <article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">How To Deploy Mirth Connect To Kubernetes</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card">
                <span class="byline-name fn p-name" itemprop="author">
                    Chillar Anand
                </span>
            </p>

            <p class="dateline">
                    9 min read
            </p>

            <p class="dateline">
                <a href="#" rel="bookmark">
                    <time class="published dt-published" datetime="2020-09-30T23:25:46+05:30" itemprop="datePublished" title="2020-09-30">2020-09-30</time></a>
            </p>
            
        </div>

        
    </header><div class="e-content entry-content" itemprop="articleBody text">
            <h4>Introduction</h4>
<p>NextGen Connect(previously Mirth Connect) is widely used integration engine for information exchange in health-care domain. In this article, let us see how to deploy Mirth Connect to a Kubernetes cluster.</p>
<h4>Deployment To k8s</h4>
<p>From version 3.8, NextGen has started providing official docker images for Connect<sup id="fnref:nc"><a class="footnote-ref" href="deploy-mirth-to-kubernetes.html#fn:nc">1</a></sup>. By default, Connect docker exposes 8080, 8443 ports. We can start a Connect instance locally, by running the following command.</p>
<div class="code"><pre class="code literal-block"><span class="nv">$docker</span><span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:8080<span class="w"> </span>-p<span class="w"> </span><span class="m">8443</span>:8443<span class="w"> </span>nextgenhealthcare/connect
</pre></div>

<p>We can use this docker image and create a k8s deployment to start a container.</p>
<div class="code"><pre class="code literal-block"><span class="o">---</span>
<span class="nv">apiVersion</span>:<span class="w"> </span><span class="nv">apps</span><span class="o">/</span><span class="nv">v1beta1</span>
<span class="nv">kind</span>:<span class="w"> </span><span class="nv">Deployment</span>
<span class="nv">metadata</span>:
<span class="w">  </span><span class="nv">name</span>:<span class="w"> </span><span class="nv">mirth</span><span class="o">-</span><span class="k">connect</span>
<span class="w">  </span><span class="nv">namespace</span>:<span class="w"> </span><span class="nv">default</span>
<span class="nv">spec</span>:
<span class="w">  </span><span class="nv">template</span>:
<span class="w">    </span><span class="nv">spec</span>:
<span class="w">      </span><span class="nv">containers</span>:
<span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="nv">name</span>:<span class="w"> </span><span class="nv">mirth</span><span class="o">-</span><span class="k">connect</span>
<span class="w">        </span><span class="nv">image</span>:<span class="w"> </span><span class="nv">docker</span>.<span class="nv">io</span><span class="o">/</span><span class="nv">nextgenhealthcare</span><span class="o">/</span><span class="k">connect</span>
<span class="w">        </span><span class="nv">ports</span>:
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nv">name</span>:<span class="w"> </span><span class="nv">http</span>
<span class="w">          </span><span class="nv">containerPort</span>:<span class="w"> </span><span class="mi">8080</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nv">name</span>:<span class="w"> </span><span class="nv">https</span>
<span class="w">          </span><span class="nv">containerPort</span>:<span class="w"> </span><span class="mi">8443</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nv">name</span>:<span class="w"> </span><span class="nv">hl7</span><span class="o">-</span><span class="nv">test</span>
<span class="w">          </span><span class="nv">containerPort</span>:<span class="w"> </span><span class="mi">9001</span>
<span class="w">        </span><span class="nv">env</span>:
<span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="nv">name</span>:<span class="w"> </span><span class="nv">DATABASE</span>
<span class="w">            </span><span class="nv">value</span>:<span class="w"> </span><span class="nv">postgres</span>
<span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="nv">name</span>:<span class="w"> </span><span class="nv">DATABASE_URL</span>
<span class="w">            </span><span class="nv">value</span>:<span class="w"> </span><span class="nv">jdbc</span>:<span class="nv">postgresql</span>:<span class="o">//</span><span class="nv">avilpage</span>.<span class="nv">com</span>:<span class="mi">5432</span><span class="o">/</span><span class="nv">mirth_db</span>
</pre></div>

<p>This deployment file can be applied on a cluster using <code>kubectl</code>.</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>connect-deployment.yaml
</pre></div>

<p>To access this container, we can create a service to expose this deployment to public.</p>
<div class="code"><pre class="code literal-block"><span class="o">---</span>
<span class="n">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="n">v1</span>
<span class="n">kind</span><span class="p">:</span><span class="w"> </span><span class="n">Service</span>
<span class="n">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">mirth</span><span class="o">-</span><span class="n">connect</span>
<span class="w">  </span><span class="n">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="n">service</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">aws</span><span class="o">-</span><span class="nb">load</span><span class="o">-</span><span class="n">balancer</span><span class="o">-</span><span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="p">:</span><span class="w"> </span><span class="n">arn</span><span class="p">:</span><span class="n">aws</span><span class="p">:</span><span class="n">acm</span><span class="p">:</span><span class="n">ap</span><span class="o">-</span><span class="n">south</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">foo</span>
<span class="w">    </span><span class="n">service</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">aws</span><span class="o">-</span><span class="nb">load</span><span class="o">-</span><span class="n">balancer</span><span class="o">-</span><span class="n">ssl</span><span class="o">-</span><span class="n">ports</span><span class="p">:</span><span class="w"> </span><span class="s2">"443"</span>
<span class="w">    </span><span class="n">external</span><span class="o">-</span><span class="n">dns</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">hostname</span><span class="p">:</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="n">avilpage</span><span class="o">.</span><span class="n">com</span>
<span class="n">spec</span><span class="p">:</span>
<span class="w">  </span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="n">LoadBalancer</span>
<span class="w">  </span><span class="n">selector</span><span class="p">:</span>
<span class="w">    </span><span class="n">app</span><span class="p">:</span><span class="w"> </span><span class="n">mirth</span><span class="o">-</span><span class="n">connect</span>
<span class="w">  </span><span class="n">ports</span><span class="p">:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">http</span>
<span class="w">      </span><span class="n">port</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span>
<span class="w">      </span><span class="n">targetPort</span><span class="p">:</span><span class="w"> </span><span class="mi">8080</span>
<span class="w">      </span><span class="n">protocol</span><span class="p">:</span><span class="w"> </span><span class="n">TCP</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">https</span>
<span class="w">      </span><span class="n">port</span><span class="p">:</span><span class="w"> </span><span class="mi">443</span>
<span class="w">      </span><span class="n">targetPort</span><span class="p">:</span><span class="w"> </span><span class="mi">8443</span>
<span class="w">      </span><span class="n">protocol</span><span class="p">:</span><span class="w"> </span><span class="n">TCP</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">hl7</span><span class="o">-</span><span class="n">test</span>
<span class="w">      </span><span class="n">port</span><span class="p">:</span><span class="w"> </span><span class="mi">9001</span>
<span class="w">      </span><span class="n">targetPort</span><span class="p">:</span><span class="w"> </span><span class="mi">9001</span>
<span class="w">      </span><span class="n">protocol</span><span class="p">:</span><span class="w"> </span><span class="n">TCP</span>
</pre></div>

<p>This will create a load balancer in AWS through which we can access mirth connect instance. If an ingress controller is present in the cluster, we can use it directly instead of using a seperate load balancer for this service.</p>
<p>Once Mirth Connect is up &amp; running, we might have to create HL7 channels running on various ports. In the above configuration files, we have exposed 9001 HL7 port for testing of channel. Once we configure Mirth Channels, we need to expose appropriate ports in deployment as well as service similiar to this.</p>
<h4>Conclusion</h4>
<p>Earlier, there were no official docker images for Mirth Connect and it was bit diffucult to dockerize Mirth Connect and deploy it. With the release of official Docker images, deploying Mirth Connect to k8s or any other container orchestration platform has become much easier.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:nc">
<p><a href="https://hub.docker.com/r/nextgenhealthcare/connect/">https://hub.docker.com/r/nextgenhealthcare/connect/</a> <a class="footnote-backref" href="deploy-mirth-to-kubernetes.html#fnref:nc" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
        </div>
        <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../tags/aws.html" rel="tag">aws</a></li>
            <li><a class="tag p-category" href="../../tags/devops.html" rel="tag">devops</a></li>
            <li><a class="tag p-category" href="../../tags/healthit.html" rel="tag">HealthIT</a></li>
            <li><a class="tag p-category" href="../../tags/kubernetes.html" rel="tag">kubernetes</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../08/bluetooth-terminal-python-asyncio.html" rel="prev" title="Serial Bluetooth Terminal With Python Asyncio">Previous post</a>
            </li>
            <li class="next">
                <a href="../10/python-docker-build-slim-fast.html" rel="next" title="Make Python Docker Builds Slim &amp; Fast">Next post</a>
            </li>
        </ul></nav></aside><div class="full-article-footer">
            <div class="article-footer">

                <div class="avatar-module">
                    <img class="avatar" height="100px" src="../../images/chillaranand.jpg">
</div>

                <p class="avatar-module">
                    <b>Chillar Anand</b>
                    <br>
                    A blog about python, careers &amp; life.
                    <br>
                    To contact me, <a href="https://forms.gle/Hre4z4aLqJA5zYWe6">send a message here</a>.
                </p>

            </div>
        </div>

        
    </article><!--End of body content--><footer id="footer"><div class="container align-items-center justify-content-center d-flex">

<footer class="footer"><a href="https://github.com/ChillarAnand">
<img src="../../images/icons8-github.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://stackoverflow.com/users/2698552/chillar-anand">
<img src="../../images/icons8-so.svg" alt="github-chillar-anand" height="30"></a>

  

<a href="https://youtube.com/@avilpage">
<img src="../../images/icons8-youtube.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://linkedin.com/in/chillaranand">
<img src="../../images/icons8-linkedin.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://twitter.com/chillaranand">
<img src="../../images/icons8-twitter.svg" alt="github-chillar-anand" height="34"></a>

</footer>
</div>

<br><br></footer>
</div>
    </div>
    </div>

                <script src="../../assets/js/jquery.min.js"></script><script src="../../assets/js/popper.min.js"></script><script src="../../assets/js/bootstrap.min.js"></script><script src="../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
