<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="How to Deploy NextGen Connect (aka Mirth Connect) to a Kubernetes cluster.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How To Deploy Mirth Connect To Kubernetes | Avil Page</title>
<link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/bootblog.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="http://avilpage.com/2020/07/deploy-mirth-to-kubernetes.html">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Chillar Anand">
<link rel="prev" href="../08/bluetooth-terminal-python-asyncio.html" title="Serial Bluetooth Terminal With Python Asyncio" type="text/html">
<link rel="next" href="../10/python-docker-build-slim-fast.html" title="Make Python Docker Builds Slim &amp; Fast" type="text/html">
<meta property="og:site_name" content="Avil Page">
<meta property="og:title" content="How To Deploy Mirth Connect To Kubernetes">
<meta property="og:url" content="http://avilpage.com/2020/07/deploy-mirth-to-kubernetes.html">
<meta property="og:description" content="How to Deploy NextGen Connect (aka Mirth Connect) to a Kubernetes cluster.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-09-30T23:25:46+05:30">
<meta property="article:tag" content="devops">
<meta property="article:tag" content="health-care">
<meta property="article:tag" content="kubernetes">
<meta property="article:tag" content="mirth-connect">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="../../">

            <span id="blog-title">Avil Page</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item">
    <a href="deploy-mirth-to-kubernetes.md" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="../../" class="nav-link">Articles</a>
                </li>
<li class="nav-item">
<a href="../../p/talks.html" class="nav-link">Talks</a>
                </li>
<li class="nav-item">
<a href="../../p/projects.html" class="nav-link">Projects</a>
                </li>
<li class="nav-item">
<a href="../../p/pages.html" class="nav-link">Pages</a>
                </li>
<li class="nav-item">
<a href="../../p/about.html" class="nav-link">About</a>
                </li>
<li class="nav-item">
<a href="https://forms.gle/Hre4z4aLqJA5zYWe6" class="nav-link">Contact</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">How To Deploy Mirth Connect To Kubernetes</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Chillar Anand
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2020-09-30T23:25:46+05:30" itemprop="datePublished" title="2020-09-30">2020-09-30</time></a>
            </p>
            
        <p class="sourceline"><a href="deploy-mirth-to-kubernetes.md" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <h4>Introduction</h4>
<p>NextGen Connect(previously Mirth Connect) is widely used integration engine for information exchange in health-care domain. In this article, let us see how to deploy Mirth Connect to a Kubernetes cluster.</p>
<h4>Deployment To k8s</h4>
<p>From version 3.8, NextGen has started providing official docker images for Connect<sup id="fnref:nc"><a class="footnote-ref" href="deploy-mirth-to-kubernetes.html#fn:nc">1</a></sup>. By default, Connect docker exposes 8080, 8443 ports. We can start a Connect instance locally, by running the following command.</p>
<div class="code"><pre class="code literal-block"><span class="nv">$docker</span> run -p <span class="m">8080</span>:8080 -p <span class="m">8443</span>:8443 nextgenhealthcare/connect
</pre></div>

<p>We can use this docker image and create a k8s deployment to start a container.</p>
<div class="code"><pre class="code literal-block"><span class="o">---</span>
<span class="nv">apiVersion</span>: <span class="nv">apps</span><span class="o">/</span><span class="nv">v1beta1</span>
<span class="nv">kind</span>: <span class="nv">Deployment</span>
<span class="nv">metadata</span>:
  <span class="nv">name</span>: <span class="nv">mirth</span><span class="o">-</span><span class="k">connect</span>
  <span class="nv">namespace</span>: <span class="nv">default</span>
<span class="nv">spec</span>:
  <span class="nv">template</span>:
    <span class="nv">spec</span>:
      <span class="nv">containers</span>:
      <span class="o">-</span> <span class="nv">name</span>: <span class="nv">mirth</span><span class="o">-</span><span class="k">connect</span>
        <span class="nv">image</span>: <span class="nv">docker</span>.<span class="nv">io</span><span class="o">/</span><span class="nv">nextgenhealthcare</span><span class="o">/</span><span class="k">connect</span>
        <span class="nv">ports</span>:
        <span class="o">-</span> <span class="nv">name</span>: <span class="nv">http</span>
          <span class="nv">containerPort</span>: <span class="mi">8080</span>
        <span class="o">-</span> <span class="nv">name</span>: <span class="nv">https</span>
          <span class="nv">containerPort</span>: <span class="mi">8443</span>
        <span class="o">-</span> <span class="nv">name</span>: <span class="nv">hl7</span><span class="o">-</span><span class="nv">test</span>
          <span class="nv">containerPort</span>: <span class="mi">9001</span>
        <span class="nv">env</span>:
          <span class="o">-</span> <span class="nv">name</span>: <span class="nv">DATABASE</span>
            <span class="nv">value</span>: <span class="nv">postgres</span>
          <span class="o">-</span> <span class="nv">name</span>: <span class="nv">DATABASE_URL</span>
            <span class="nv">value</span>: <span class="nv">jdbc</span>:<span class="nv">postgresql</span>:<span class="o">//</span><span class="nv">avilpage</span>.<span class="nv">com</span>:<span class="mi">5432</span><span class="o">/</span><span class="nv">mirth_db</span>
</pre></div>

<p>This deployment file can be applied on a cluster using <code>kubectl</code>.</p>
<div class="code"><pre class="code literal-block">$ kubectl apply -f connect-deployment.yaml
</pre></div>

<p>To access this container, we can create a service to expose this deployment to public.</p>
<div class="code"><pre class="code literal-block"><span class="o">---</span><span class="w"></span>
<span class="n">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="n">v1</span><span class="w"></span>
<span class="n">kind</span><span class="p">:</span><span class="w"> </span><span class="n">Service</span><span class="w"></span>
<span class="n">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">mirth</span><span class="o">-</span><span class="n">connect</span><span class="w"></span>
<span class="w">  </span><span class="n">annotations</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">service</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">aws</span><span class="o">-</span><span class="nb">load</span><span class="o">-</span><span class="n">balancer</span><span class="o">-</span><span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="p">:</span><span class="w"> </span><span class="n">arn</span><span class="p">:</span><span class="n">aws</span><span class="p">:</span><span class="n">acm</span><span class="p">:</span><span class="n">ap</span><span class="o">-</span><span class="n">south</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">foo</span><span class="w"></span>
<span class="w">    </span><span class="n">service</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">aws</span><span class="o">-</span><span class="nb">load</span><span class="o">-</span><span class="n">balancer</span><span class="o">-</span><span class="n">ssl</span><span class="o">-</span><span class="n">ports</span><span class="p">:</span><span class="w"> </span><span class="s2">"443"</span><span class="w"></span>
<span class="w">    </span><span class="n">external</span><span class="o">-</span><span class="n">dns</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">hostname</span><span class="p">:</span><span class="w"> </span><span class="n">connect</span><span class="o">.</span><span class="n">avilpage</span><span class="o">.</span><span class="n">com</span><span class="w"></span>
<span class="n">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="n">LoadBalancer</span><span class="w"></span>
<span class="w">  </span><span class="n">selector</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">app</span><span class="p">:</span><span class="w"> </span><span class="n">mirth</span><span class="o">-</span><span class="n">connect</span><span class="w"></span>
<span class="w">  </span><span class="n">ports</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">http</span><span class="w"></span>
<span class="w">      </span><span class="n">port</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="w"></span>
<span class="w">      </span><span class="n">targetPort</span><span class="p">:</span><span class="w"> </span><span class="mi">8080</span><span class="w"></span>
<span class="w">      </span><span class="n">protocol</span><span class="p">:</span><span class="w"> </span><span class="n">TCP</span><span class="w"></span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">https</span><span class="w"></span>
<span class="w">      </span><span class="n">port</span><span class="p">:</span><span class="w"> </span><span class="mi">443</span><span class="w"></span>
<span class="w">      </span><span class="n">targetPort</span><span class="p">:</span><span class="w"> </span><span class="mi">8443</span><span class="w"></span>
<span class="w">      </span><span class="n">protocol</span><span class="p">:</span><span class="w"> </span><span class="n">TCP</span><span class="w"></span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">hl7</span><span class="o">-</span><span class="n">test</span><span class="w"></span>
<span class="w">      </span><span class="n">port</span><span class="p">:</span><span class="w"> </span><span class="mi">9001</span><span class="w"></span>
<span class="w">      </span><span class="n">targetPort</span><span class="p">:</span><span class="w"> </span><span class="mi">9001</span><span class="w"></span>
<span class="w">      </span><span class="n">protocol</span><span class="p">:</span><span class="w"> </span><span class="n">TCP</span><span class="w"></span>
</pre></div>

<p>This will create a load balancer in AWS through which we can access mirth connect instance. If an ingress controller is present in the cluster, we can use it directly instead of using a seperate load balancer for this service.</p>
<p>Once Mirth Connect is up &amp; running, we might have to create HL7 channels running on various ports. In the above configuration files, we have exposed 9001 HL7 port for testing of channel. Once we configure Mirth Channels, we need to expose appropriate ports in deployment as well as service similiar to this.</p>
<h4>Conclusion</h4>
<p>Earlier, there were no official docker images for Mirth Connect and it was bit diffucult to dockerize Mirth Connect and deploy it. With the release of official Docker images, deploying Mirth Connect to k8s or any other container orchestration platform has become much easier.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:nc">
<p><a href="https://hub.docker.com/r/nextgenhealthcare/connect/">https://hub.docker.com/r/nextgenhealthcare/connect/</a> <a class="footnote-backref" href="deploy-mirth-to-kubernetes.html#fnref:nc" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../tags/devops.html" rel="tag">devops</a></li>
            <li><a class="tag p-category" href="../../tags/health-care.html" rel="tag">health-care</a></li>
            <li><a class="tag p-category" href="../../tags/kubernetes.html" rel="tag">kubernetes</a></li>
            <li><a class="tag p-category" href="../../tags/mirth-connect.html" rel="tag">mirth-connect</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../08/bluetooth-terminal-python-asyncio.html" rel="prev" title="Serial Bluetooth Terminal With Python Asyncio">Previous post</a>
            </li>
            <li class="next">
                <a href="../10/python-docker-build-slim-fast.html" rel="next" title="Make Python Docker Builds Slim &amp; Fast">Next post</a>
            </li>
        </ul></nav></aside></article><!--End of body content--><footer id="footer">
            Contents © 2022         <a href="mailto:">Chillar Anand</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


            <script src="../../assets/js/jquery.min.js"></script><script src="../../assets/js/popper.min.js"></script><script src="../../assets/js/bootstrap.min.js"></script><script src="../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
