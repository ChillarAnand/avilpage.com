<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-81644162-1"></script><script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-81644162-1');
        </script><meta name="description" content="How to load test web sockets with modern load testing tools">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How To Load Testing WebSockets? | Avil Page</title>
<link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<!-- <link href="/assets/css/rst_base.css" rel="stylesheet" type="text/css"> --><link href="../../assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/style.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://avilpage.com/2018/09/guide-to-load-testing-websockets.html">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Chillar Anand">
<link rel="prev" href="../08/parsing-and-transforming-mitmproxy-request-flows.html" title="Parsing &amp; Transforming mitmproxy Request Flows" type="text/html">
<meta property="og:site_name" content="Avil Page">
<meta property="og:title" content="How To Load Testing WebSockets?">
<meta property="og:url" content="http://avilpage.com/2018/09/guide-to-load-testing-websockets.html">
<meta property="og:description" content="How to load test web sockets with modern load testing tools">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-09-24T14:21:21+05:30">
<meta property="article:tag" content="devops">
<meta property="article:tag" content="load-testing">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://avilpage.com/">

                <span id="blog-title">Avil Page</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../">Articles</a>
                </li>
<li>
<a href="../../p/talks.html">Talks</a>
                </li>
<li>
<a href="../../p/projects.html">Projects</a>
                </li>
<li>
<a href="../../p/about.html">About</a>
                </li>
<li>
<a href="../../rss.xml">RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="guide-to-load-testing-websockets.md" id="sourcelink">Source</a>
    </li>
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content col-lg-6 col-lg-offset-3 col-xs-12 col-md-12">
        <!--Body content-->
        <div class="row">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">How To Load Testing WebSockets?</a></h1>

        <div class="metadata">
            <p class="dateline">
                <time class="published dt-published" datetime="2018-09-24T14:21:21+05:30" itemprop="datePublished" title="24 Sep 18">24 Sep 2018</time></p>
            |
            

        2 min read


        </div>
        
    </header><hr>
<div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>An important part of load testing is finding a right tool that fits our needs. Here are some tools for load testing websockets.</p>
<ul>
<li><a href="https://www.npmjs.com/package/thor">thor</a></li>
<li><a href="https://www.npmjs.com/package/thor">artillery</a></li>
<li><a href="https://github.com/loadimpact/k6">k6</a></li>
<li><a href="https://github.com/Fitblip/wsstat">wsstat</a></li>
<li><a href="https://github.com/M6Web/websocket-bench">websocket-bench</a></li>
<li><a href="https://github.com/processone/tsung">tsung</a></li>
<li>
<a href="https://jmeter.apache.org/">Jmeter</a>(requires plugin)</li>
</ul>
<p>For this tutorial, we will be using artillery for load testing as it supports quick testing from command line as well as simulating real scenarios from yml config file. It also has inbuilt support for reports.</p>
<p>Install node &amp; npm on the system with apt package manager.</p>
<pre class="code literal-block"><span></span>$ sudo apt install -y nodejs npm
</pre>


<p>Install artillery with npm.</p>
<pre class="code literal-block"><span></span>$ npm install -g artillery
</pre>


<p>Lets write a simple configuration file to test echo websocket at wss://echo.websocket.com</p>
<p>Artillery script is composed of two sections: <code>config</code> and <code>scenarios</code>. The <code>config</code> section defines the target, load, environment and other configurations. The <code>scenarios</code> section contains definitions of test cases that will be executed.</p>
<pre class="code literal-block"><span></span>  config:
    target: "wss://echo.websocket.org"
    phases:
      - duration: 600
        arrivalRate: 100
        name: "Steady users"


  scenarios:
    - engine: "ws"
      flow:
        - send: "hello"
</pre>


<p>This script will create 100 virtual users every second for 600 seconds. Each virtual user will connect to the socket and send <code>hello</code> after websocket connection is established.</p>
<p>Save this script to a file called <code>load.yml</code> and run it.</p>
<pre class="code literal-block"><span></span>$ artillery run load.yml -o results.json
</pre>


<p>Once load testing is completed, it will save results to <code>results.json</code> file. Artillery can convert this json to graphs for visualization. To see a detailed report, run</p>
<pre class="code literal-block"><span></span>$ artillery report results.json
</pre>


<p>Here is a sample report generated with artillery.</p>
<p align="center">
<img src="../../images/load-testing-report.png"></p>

<p>For quick loadtesting and to see how server performs under given load, artillery will be sufficient. Artillery doesn't support websocket responses yet. For load testing scenarios based on websocket responses, Jmeter or tsung can be used.</p>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../tags/devops.html" rel="tag">devops</a></li>
            <li><a class="tag p-category" href="../../tags/load-testing.html" rel="tag">load-testing</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../08/parsing-and-transforming-mitmproxy-request-flows.html" rel="prev" title="Parsing &amp; Transforming mitmproxy Request Flows">Previous post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="avilpage",
            disqus_url="http://avilpage.com/2018/09/guide-to-load-testing-websockets.html",
        disqus_title="How To Load Testing WebSockets?",
        disqus_identifier="cache/posts/2018/09/a-guide-to-load-testing-websockets.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="avilpage";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents Â© 2018         <a href="mailto:">Chillar Anand</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>

            <script src="../../assets/js/jquery.min.js"></script><script src="../../assets/js/bootstrap.min.js"></script><script src="../../assets/js/baguetteBox.min.js"></script><script src="../../assets/js/moment-with-locales.min.js"></script><script src="../../assets/js/fancydates.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
