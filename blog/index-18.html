<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Avil Page - Personal &amp; tech blog by Chillar Anand">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Avil Page (old posts, page 18) | Avil Page</title>
<link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../assets/css/theme.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../rss.xml">
<link rel="canonical" href="https://avilpage.com/blog/index-18.html">
<link rel="prev" href="." type="text/html">
<link rel="next" href="index-17.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><style>

 h1 {
     font-weight: bold;
     font-size: 25px;
 }

</style>
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

    <!-- Menubar -->
    <nav class="navbar navbar-expand-md static-top mb-4
                navbar-dark
                bg-dark
                "><div class="container">
<!-- This keeps the margins nice -->
            <a class="navbar-brand" href="../">

                    <span id="blog-title">Avil Page</span>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="bs-navbar">
                <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../top-10.html" class="nav-link">Top 10</a>
                </li>
<li class="nav-item">
<a href="../archive.html" class="nav-link">Tech</a>
                </li>
<li class="nav-item">
<a href="../non-tech.html" class="nav-link">Non-tech</a>
                </li>
<li class="nav-item">
<a href="../rss.xml" class="nav-link">RSS</a>

                    
                </li>
</ul>
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
        </div>
<!-- /.container -->
    </nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="row justify-content-md-center">
        <div class="body-content col col-lg-6">
            <!--Body content-->
            
    
    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../2023/04/reduce-system-load-with-chatgpt.html" class="u-url">Reducing System Load With ChatGPT</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Chillar Anand
            </span></p>
            <p class="dateline">
            <a href="../2023/04/reduce-system-load-with-chatgpt.html" rel="bookmark">
            <time class="published dt-published" datetime="2023-04-01T07:55:49+05:30" itemprop="datePublished" title="2023-04-01">2023-04-01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <h4>Problem Statement</h4>
<p>I am using M1 Macbook Air for Python development purposes. Since M1 uses ARM architecture, many Python packages don't have wheels for ARM64/aarch64. confluent-kafka-python is one of them. </p>
<p>I had to run AMD64 docker container to use confluent-kafka-python. Since it is a cross-architecture container, its CPU usage is too high and performance was too slow.  </p>
<h4>Solution</h4>
<p>To reduce system load, I decided to build aarch64 wheels for confluent-kafka-python. I looked at open issues on GitHub and asked maintainers how to build aarch64 wheels. There was no response<sup id="fnref:librdkafka"><a class="footnote-ref" href="../2023/04/reduce-system-load-with-chatgpt.html#fn:librdkafka">1</a></sup> from them.</p>
<p>As a workaround, I asked ChatGPT<sup id="fnref:chatgpt"><a class="footnote-ref" href="../2023/04/reduce-system-load-with-chatgpt.html#fn:chatgpt">2</a></sup> on how to build confluent-kafka-python aarch64 wheels in a docker container.</p>
<p align="center">
<img src="../images/chatgpt-reduce-system-load.png" alt="chatgpt-reduce-system-load"></p>

<p>This initial suggestion didn't work as <code>confluent-kafka-python</code> depends on <code>librdkafka</code> which is a C library. I had to build <code>librdkafka</code> from source for aarch64 and then build <code>confluent-kafka-python</code> from source.</p>
<p>To build <code>librdkafka</code> from the source, I again asked ChatGPT. After making minor changes to the snippet suggested by ChatGPT, I was able to build <code>librdkafka</code> from the source for aarch64.</p>
<p>Here is the final snippet:</p>
<pre class="code literal-block"><span class="n">FROM</span> <span class="n">ubuntu</span><span class="p">:</span><span class="mf">22.04</span>

<span class="n">ARG</span> <span class="n">DEBIAN_FRONTEND</span><span class="o">=</span><span class="n">noninteractive</span>

<span class="n">RUN</span> <span class="n">apt</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">apt</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> \
  <span class="n">wget</span> <span class="n">git</span> <span class="n">curl</span> <span class="n">g</span><span class="o">++</span> <span class="n">make</span> <span class="n">postgresql</span><span class="o">-</span><span class="n">client</span> \
  <span class="n">nano</span> <span class="n">less</span> <span class="n">shared</span><span class="o">-</span><span class="n">mime</span><span class="o">-</span><span class="n">info</span> <span class="n">openjdk</span><span class="o">-</span><span class="mi">17</span><span class="o">-</span><span class="n">jre</span><span class="o">-</span><span class="n">headless</span> \
  <span class="n">libpq</span><span class="o">-</span><span class="n">dev</span> <span class="n">vim</span> <span class="n">tzdata</span> <span class="n">python3</span> <span class="n">python3</span><span class="o">-</span><span class="n">dev</span>

<span class="n">RUN</span> <span class="n">apt</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">python3</span><span class="o">-</span><span class="n">pip</span>
<span class="n">RUN</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">setuptools</span>

<span class="n">WORKDIR</span> <span class="o">/</span>
<span class="n">RUN</span> <span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">confluentinc</span><span class="o">/</span><span class="n">confluent</span><span class="o">-</span><span class="n">kafka</span><span class="o">-</span><span class="n">python</span>
<span class="n">WORKDIR</span> <span class="n">confluent</span><span class="o">-</span><span class="n">kafka</span><span class="o">-</span><span class="n">python</span>

<span class="n">COPY</span> <span class="o">.</span> <span class="o">/</span><span class="n">app</span>
<span class="n">WORKDIR</span> <span class="o">/</span><span class="n">app</span>
<span class="n">RUN</span> <span class="o">./</span><span class="n">configure</span> <span class="o">--</span><span class="n">arch</span><span class="o">=</span><span class="n">aarch64</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=/</span><span class="n">usr</span>
<span class="n">RUN</span> <span class="n">make</span>
<span class="n">RUN</span> <span class="n">make</span> <span class="n">install</span>

<span class="n">WORKDIR</span> <span class="o">/</span><span class="n">confluent</span><span class="o">-</span><span class="n">kafka</span><span class="o">-</span><span class="n">python</span>
<span class="n">RUN</span> <span class="n">python3</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre>
<h4>Conclusion</h4>
<p>By running native containers, I was able to reduce the system load by ~50%. With ChatGPT, it is easy to build/tweak programs in languages &amp; environments that we are not familiar with.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:librdkafka">
<p><a href="https://github.com/confluentinc/librdkafka/issues/3546#issuecomment-1340237177">https://github.com/confluentinc/librdkafka/3546</a> <a class="footnote-backref" href="../2023/04/reduce-system-load-with-chatgpt.html#fnref:librdkafka" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:chatgpt">
<p><a href="https://en.wikipedia.org/wiki/ChatGPT">https://en.wikipedia.org/wiki/ChatGPT</a> <a class="footnote-backref" href="../2023/04/reduce-system-load-with-chatgpt.html#fnref:chatgpt" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../2023/03/custom-action-mac-finder.html" class="u-url">Automator Quick Action for KDiff3 in Finder</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Chillar Anand
            </span></p>
            <p class="dateline">
            <a href="../2023/03/custom-action-mac-finder.html" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-10T08:24:11+05:30" itemprop="datePublished" title="2023-03-10">2023-03-10</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <h4>The need for quick action</h4>
<p>kdiff3<sup id="fnref:kdiff3"><a class="footnote-ref" href="../2023/03/custom-action-mac-finder.html#fn:kdiff3">1</a></sup> is a diff &amp; merge tool that compares multiple files/directories and shows the difference line by line and character by character as shown below.</p>
<p><img src="../images/mac-finder-kdiff3.png" alt="mac-finder-kdiff3"></p>
<p>In Windows, when we select multiple files/directories and right click on them, it will show the option to compare selected items with kdiff3.</p>
<p><img src="../images/mac-finder-kdiff3-windows.png" alt="mac-finder-kdiff3-windows"></p>
<p>However, in Macbook, it doesn't show this option. In this tutorial, let us see how we can create the same quick action in the right-click menu when we right-click on the files/directories.</p>
<h4>Creating Quick Action</h4>
<p>Let us open Automator<sup id="fnref:automator"><a class="footnote-ref" href="../2023/03/custom-action-mac-finder.html#fn:automator">2</a></sup>, create new file and select Quick Action.</p>
<p><img src="../images/mac-finder-quick-action.png" alt="mac-finder-automator"></p>
<p>On the left side select <code>Utilities</code> and then select <code>Run Shell Script</code>. </p>
<p>For Workflow receives current, select <code>files or folders</code> and then select <code>in Finder</code>. </p>
<p><img src="../images/mac-finder-quick-action2.png" alt="mac-finder-quick-action"></p>
<p>Then select pass input <code>as agruments</code> and in the script section let us add the following command.</p>
<pre class="code literal-block">/path/to/kdiff3 <span class="nv">$1</span> <span class="nv">$2</span>
</pre>
<p>After adding the command, save this Quick Action. </p>
<p>Now if we relaunch Finder app and then select multiple directories, and right click we can see <code>Compare with KDiff3</code> in quick actions.</p>
<p><img src="../images/mac-finder-kdiff3-quick-action.png" alt="mac-finder-kdiff3"></p>
<h4>Conclusion</h4>
<p>Even though we can use the command line to compare the files/directories, it is always good to have a quick action in the right-click menu. </p>
<div class="footnote">
<hr>
<ol>
<li id="fn:kdiff3">
<p><a href="https://kdiff3.sourceforge.io">https://kdiff3.sourceforge.io</a> <a class="footnote-backref" href="../2023/03/custom-action-mac-finder.html#fnref:kdiff3" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:automator">
<p><a href="https://en.wikipedia.org/wiki/Automator_(macOS)">https://en.wikipedia.org/wiki/Automator_(macOS)</a> <a class="footnote-backref" href="../2023/03/custom-action-mac-finder.html#fnref:automator" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
    </div>
    </article>
</div>
        <ul class="pager postindexpager clearfix">
<li class="previous"><a href="." rel="prev">Newer posts</a></li>
            <li class="next"><a href="index-17.html" rel="next">Older posts</a></li>
        </ul>
<!--End of body content--><footer id="footer"><div class="container align-items-center justify-content-center d-flex">

<footer class="footer"><a href="https://github.com/ChillarAnand">
<img src="../images/icons8-github.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://stackoverflow.com/users/2698552/chillar-anand">
<img src="../images/icons8-so.svg" alt="github-chillar-anand" height="30"></a>

  

<a href="https://youtube.com/@avilpage">
<img src="../images/icons8-youtube.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://linkedin.com/in/chillaranand">
<img src="../images/icons8-linkedin.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://twitter.com/chillaranand">
<img src="../images/icons8-twitter.svg" alt="github-chillar-anand" height="34"></a>

</footer>
</div>

<br><br></footer>
</div>
    </div>
    </div>

                <script src="../assets/js/jquery.min.js"></script><script src="../assets/js/popper.min.js"></script><script src="../assets/js/bootstrap.min.js"></script><script src="../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
