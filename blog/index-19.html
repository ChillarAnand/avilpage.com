<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Avil Page - Personal &amp; tech blog by Chillar Anand">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Avil Page (old posts, page 19) | Avil Page</title>
<link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../assets/css/theme.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../rss.xml">
<link rel="canonical" href="https://avilpage.com/blog/index-19.html">
<link rel="prev" href="." type="text/html">
<link rel="next" href="index-18.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><style>

 h1 {
     font-weight: bold;
     font-size: 25px;
 }

</style>
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

    <!-- Menubar -->
    <nav class="navbar navbar-expand-md static-top mb-4
                navbar-dark
                bg-dark
                "><div class="container">
<!-- This keeps the margins nice -->
            <a class="navbar-brand" href="../">

                    <span id="blog-title">Avil Page</span>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="bs-navbar">
                <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../top-10.html" class="nav-link">Top 10</a>
                </li>
<li class="nav-item">
<a href="../archive.html" class="nav-link">Tech</a>
                </li>
<li class="nav-item">
<a href="../rss.xml" class="nav-link">RSS</a>

                    
                </li>
</ul>
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
        </div>
<!-- /.container -->
    </nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="row justify-content-md-center">
        <div class="body-content col col-lg-6">
            <!--Body content-->
            
    
    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../2023/10/guide-to-setting-up-geodjango-on-mac-m1.html" class="u-url">Guide to setting up GeoDjango on Mac M1</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Chillar Anand
            </span></p>
            <p class="dateline">
            <a href="../2023/10/guide-to-setting-up-geodjango-on-mac-m1.html" rel="bookmark">
            <time class="published dt-published" datetime="2023-10-30T08:59:23+05:30" itemprop="datePublished" title="2023-10-30">2023-10-30</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>There are a lot of guides on setting up GeoDjango and PostGIS. But most of them are outdated and doesn't work on Mac M1. In this article, let us look at how to set up GeoDjango on Mac M1/M2.</p>
<p>Ensure you have already installed Postgres on your Mac. </p>
<h4>Install GeoDjango</h4>
<p>The default GDAL version available on brew fails to install on Mac M1.</p>
<pre class="code literal-block"><span class="err">$</span><span class="w"> </span><span class="n">brew</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">gdal</span><span class="w"></span>
<span class="o">==&gt;</span><span class="w"> </span><span class="n">cmake</span><span class="w"> </span><span class="o">--</span><span class="n">build</span><span class="w"> </span><span class="n">build</span><span class="w"></span>
<span class="k">Last</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">chillaranand</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Logs</span><span class="o">/</span><span class="n">Homebrew</span><span class="o">/</span><span class="n">gdal</span><span class="o">/</span><span class="mf">02.</span><span class="nl">cmake</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="o">[</span><span class="n">javac</span><span class="o">]</span><span class="w"> </span><span class="n">Compiling</span><span class="w"> </span><span class="mi">82</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">gdal</span><span class="o">-</span><span class="mi">20231029</span><span class="o">-</span><span class="mi">31808</span><span class="o">-</span><span class="mi">1</span><span class="n">wl9085</span><span class="o">/</span><span class="n">gdal</span><span class="o">-</span><span class="mf">3.7.2</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">swig</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">classes</span><span class="w"></span>
<span class="w">    </span><span class="o">[</span><span class="n">javac</span><span class="o">]</span><span class="w"> </span><span class="nl">warning</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">options</span><span class="o">]</span><span class="w"> </span><span class="n">bootstrap</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">conjunction</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="n">source</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="w">    </span><span class="o">[</span><span class="n">javac</span><span class="o">]</span><span class="w"> </span><span class="nl">error</span><span class="p">:</span><span class="w"> </span><span class="n">Source</span><span class="w"> </span><span class="k">option</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">supported</span><span class="p">.</span><span class="w"> </span><span class="k">Use</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">later</span><span class="p">.</span><span class="w"></span>
<span class="w">    </span><span class="o">[</span><span class="n">javac</span><span class="o">]</span><span class="w"> </span><span class="nl">error</span><span class="p">:</span><span class="w"> </span><span class="n">Target</span><span class="w"> </span><span class="k">option</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">supported</span><span class="p">.</span><span class="w"> </span><span class="k">Use</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">later</span><span class="p">.</span><span class="w"></span>

<span class="n">BUILD</span><span class="w"> </span><span class="n">FAILED</span><span class="w"></span>
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">gdal</span><span class="o">-</span><span class="mi">20231029</span><span class="o">-</span><span class="mi">31808</span><span class="o">-</span><span class="mi">1</span><span class="n">wl9085</span><span class="o">/</span><span class="n">gdal</span><span class="o">-</span><span class="mf">3.7.2</span><span class="o">/</span><span class="n">swig</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="nc">xml</span><span class="err">:</span><span class="mi">25</span><span class="err">:</span><span class="w"> </span><span class="n">Compile</span><span class="w"> </span><span class="n">failed</span><span class="p">;</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">compiler</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="w"></span>

<span class="n">Total</span><span class="w"> </span><span class="nc">time</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">seconds</span><span class="w"></span>
<span class="n">gmake</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="o">***</span><span class="w"> </span><span class="o">[</span><span class="n">swig/java/CMakeFiles/java_binding.dir/build.make:108: swig/java/gdal.jar</span><span class="o">]</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">gmake</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">Leaving</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="s1">'/private/tmp/gdal-20231029-31808-1wl9085/gdal-3.7.2/build'</span><span class="w"></span>
<span class="n">gmake</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="o">***</span><span class="w"> </span><span class="o">[</span><span class="n">CMakeFiles/Makefile2:9108: swig/java/CMakeFiles/java_binding.dir/all</span><span class="o">]</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">gmake</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">Leaving</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="s1">'/private/tmp/gdal-20231029-31808-1wl9085/gdal-3.7.2/build'</span><span class="w"></span>
<span class="nl">gmake</span><span class="p">:</span><span class="w"> </span><span class="o">***</span><span class="w"> </span><span class="o">[</span><span class="n">Makefile:139: all</span><span class="o">]</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
</pre>
<p>We can use conda to install gdal. Create a new environment and install gdal in it.</p>
<pre class="code literal-block">$ conda create -n geodjango <span class="nv">python</span><span class="o">=</span><span class="m">3</span>.9
$ conda install -c conda-forge gdal
$ pip install django
$ pip install psycopg2-binary
</pre>
<p>Once installed, you can check the version using <code>gdalinfo --version</code>.</p>
<p>Remaining dependencies can be installed via brew.</p>
<pre class="code literal-block">$ brew install postgresql
$ brew install postgis
$ brew install libgeoip
</pre>
<p>Let's create a new django project and add spatial backends.</p>
<pre class="code literal-block">$ django-admin startproject geodjango
</pre>
<p>Add <code>django.contrib.gis</code> to <code>INSTALLED_APPS</code> in <code>settings.py</code>.</p>
<pre class="code literal-block"><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="s1">'django.contrib.gis'</span><span class="p">,</span>
<span class="p">]</span>
</pre>
<p>Add the following to <code>DATABASES</code> in <code>settings.py</code>.</p>
<pre class="code literal-block"><span class="n">DATABASES</span><span class="p">[</span><span class="s1">'default'</span><span class="p">][</span><span class="s1">'ENGINE'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'django.contrib.gis.db.backends.postgis'</span>
</pre>
<p>Since we used conda to install gdal, we need to set the path to gdal in our django settings. Run <code>locate libgdal.dylib</code> to find the path to gdal.</p>
<pre class="code literal-block"><span class="n">GDAL_LIBRARY_PATH</span> <span class="o">=</span> <span class="s1">'/opt/homebrew/anaconda3/envs/geodjango/lib/libgdal.dylib'</span>
</pre>
<p>Similarly, we need to set <code>GEOS_LIBRARY_PATH</code> as well.</p>
<pre class="code literal-block"><span class="n">GEOS_LIBRARY_PATH</span> <span class="o">=</span> <span class="s1">'/opt/homebrew/anaconda3/envs/geodjango/lib/libgeos_c.dylib'</span>
</pre>
<p>Now, we can create a new app and add PointField or any other spatial fields to our models.</p>
<pre class="code literal-block">$ python manage.py startapp places
</pre>
<pre class="code literal-block"><span class="kn">from</span> <span class="nn">django.contrib.gis.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Place</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PointField</span><span class="p">()</span>
</pre>
<h4>Conclusion</h4>
<p>In this article, we looked at how to set up GeoDjango on Mac M1. We used conda to install gdal and brew to install other dependencies. </p>
    </div>
    </article>
</div>
        <ul class="pager postindexpager clearfix">
<li class="previous"><a href="." rel="prev">Newer posts</a></li>
            <li class="next"><a href="index-18.html" rel="next">Older posts</a></li>
        </ul>
<!--End of body content--><footer id="footer"><div class="container align-items-center justify-content-center d-flex">

<footer class="footer"><a href="https://github.com/ChillarAnand">
<img src="../images/icons8-github.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://stackoverflow.com/users/2698552/chillar-anand">
<img src="../images/icons8-so.svg" alt="github-chillar-anand" height="30"></a>

  

<a href="https://youtube.com/@avilpage">
<img src="../images/icons8-youtube.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://linkedin.com/in/chillaranand">
<img src="../images/icons8-linkedin.svg" alt="github-chillar-anand" height="34"></a>

  

<a href="https://twitter.com/chillaranand">
<img src="../images/icons8-twitter.svg" alt="github-chillar-anand" height="34"></a>

</footer>
</div>

<br><br></footer>
</div>
    </div>
    </div>

                <script src="../assets/js/jquery.min.js"></script><script src="../assets/js/popper.min.js"></script><script src="../assets/js/bootstrap.min.js"></script><script src="../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
